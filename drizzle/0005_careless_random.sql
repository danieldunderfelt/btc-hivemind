DROP VIEW "public"."resolved_guesses" CASCADE;--> statement-breakpoint
CREATE VIEW "public"."resolved_guesses" AS (select "guesses"."id", "guesses"."user_id", "guesses"."guess", "guesses"."guess_price", "guesses"."guessed_at", "guess_resolutions"."resolved_at", "guess_resolutions"."resolved_price", CASE WHEN ("guesses"."guess_price" < "guess_resolutions"."resolved_price" AND "guesses"."guess" = 'up') OR ("guesses"."guess_price" > "guess_resolutions"."resolved_price" AND "guesses"."guess" = 'down') THEN true ELSE false END as "is_correct", "guesses"."start_resolving_at" from "guesses" inner join "guess_resolutions" on "guesses"."id" = "guess_resolutions"."guess_id" where "guess_resolutions"."resolved_at" is not null);

CREATE VIEW "public"."all_guesses" AS (select "guesses"."id", "guesses"."user_id", "guesses"."guess", "guesses"."guess_price", "guesses"."guessed_at", "resolved_guesses"."resolved_at", "resolved_guesses"."resolved_price", "is_correct", "guesses"."start_resolving_at" from "guesses" left join "resolved_guesses" on "guesses"."id" = "resolved_guesses"."id");